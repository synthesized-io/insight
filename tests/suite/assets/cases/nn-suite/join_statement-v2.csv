TARGET,SQL_SELECT_STATEMENT,SQL_JOIN_STATEMENT
ACCOUNT - Investmentaccount,"SELECT ACCOUNT_NUMBER = CAST(CASE
    WHEN LEN(COALESCE(ER_REF.EP_NN_SECURITIESACCOUNT_ACCOUNTNUMBER,ER_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER)) = 18 THEN RIGHT(COALESCE(ER_REF.EP_NN_SECURITIESACCOUNT_ACCOUNTNUMBER,ER_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER),10)
	ELSE COALESCE(ER_REF.EP_NN_SECURITIESACCOUNT_ACCOUNTNUMBER,ER_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER)
END AS NVARCHAR(200)),BANK_CODE = CAST(CASE
    WHEN LEN(COALESCE(ER_REF.EP_NN_SECURITIESACCOUNT_ACCOUNTNUMBER,ER_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER)) = 18 THEN SUBSTRING(COALESCE(ER_REF.EP_NN_SECURITIESACCOUNT_ACCOUNTNUMBER,ER_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER),5,4)
	ELSE NULL
END AS NVARCHAR(200)),CONTRACT_IDENTIFIER = CAST(CASE
	WHEN INVO.BRONSYSTEEM = 'EP_NN' THEN CAST(INVO_REF.EP_NN_PRODUCTDETAIL_PRODUCT_ID AS NVARCHAR(250))
	WHEN INVO.BRONSYSTEEM = 'OFS' THEN CAST(INVO_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER  AS NVARCHAR(250))
	ELSE 'NA'
END AS NVARCHAR(200)),CONTRACT_SOURCE_SYSTEM_IDENTIFIER = CAST(INVO.BRONSYSTEEM AS NVARCHAR(200)),IBAN_CHECK_DIGITS = CAST(CASE
    WHEN LEN(COALESCE(ER_REF.EP_NN_SECURITIESACCOUNT_ACCOUNTNUMBER,ER_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER)) = 18 THEN SUBSTRING(COALESCE(ER_REF.EP_NN_SECURITIESACCOUNT_ACCOUNTNUMBER,ER_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER),3,2)
	ELSE NULL
END AS NVARCHAR(200)),IBAN_COUNTRY = CAST(CASE
    WHEN LEN(COALESCE(ER_REF.EP_NN_SECURITIESACCOUNT_ACCOUNTNUMBER,ER_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER)) = 18 THEN SUBSTRING(COALESCE(ER_REF.EP_NN_SECURITIESACCOUNT_ACCOUNTNUMBER,ER_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER),1,2)
	ELSE NULL
END AS NVARCHAR(200)),INTERNATIONAL_BANK_ACCOUNT_NUMBER = CAST(CASE
	WHEN ER.BRONSYSTEEM = 'EP_NN' THEN CAST(ER_REF.EP_NN_SECURITIESACCOUNT_ACCOUNTNUMBER AS NVARCHAR(250))
	WHEN ER.BRONSYSTEEM = 'OFS' THEN CAST(ER_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER  AS NVARCHAR(250))
	ELSE 'NA'
END AS NVARCHAR(200))","FROM ILSB_DDS.INVO_EFFECTENREKENING ER
     INNER JOIN ILSB_DDS.INVO_INVESTERINGSOVEREENKOMST INVO ON ER.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID
     INNER JOIN ILSB_DDS.INVO_EFFECTENREKENING_REFERENTIE ER_REF ON ER.EFFECTENREKENING_ID = ER_REF.EFFECTENREKENING_ID
     INNER JOIN ILSB_DDS.INVO_INVESTERINGSOVEREENKOMST_REFERENTIE INVO_REF ON INVO.INVESTERINGSOVEREENKOMST_ID = INVO_REF.INVESTERINGSOVEREENKOMST_ID
WHERE 1=1"
ACCOUNT - Savingsaccount,"SELECT ACCOUNT_NUMBER = CAST(CASE
    WHEN LEN(COALESCE(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER,GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER)) = 18 THEN RIGHT(COALESCE(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER,GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER),10)
	ELSE COALESCE(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER,GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER)
END AS NVARCHAR(200)),BANK_CODE = CAST(CASE
    WHEN LEN(COALESCE(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER,GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER)) = 18 THEN SUBSTRING(COALESCE(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER,GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER),5,4)
	ELSE NULL
END AS NVARCHAR(200)),CONTRACT_IDENTIFIER = CAST(CASE
	WHEN INVO.BRONSYSTEEM = 'EP_NN' THEN CAST(INVO_REF.EP_NN_PRODUCTDETAIL_PRODUCT_ID AS NVARCHAR(250))
	WHEN INVO.BRONSYSTEEM = 'OFS' THEN CAST(INVO_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER  AS NVARCHAR(250))
	ELSE 'NA'
END AS NVARCHAR(200)),CONTRACT_SOURCE_SYSTEM_IDENTIFIER = CAST(INVO.BRONSYSTEEM AS NVARCHAR(200)),IBAN_CHECK_DIGITS = CAST(CASE
    WHEN LEN(COALESCE(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER,GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER)) = 18 THEN SUBSTRING(COALESCE(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER,GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER),3,2)
	ELSE NULL
END AS NVARCHAR(200)),IBAN_COUNTRY = CAST(CASE
    WHEN LEN(COALESCE(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER,GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER)) = 18 THEN SUBSTRING(COALESCE(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER,GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER),1,2)
	ELSE NULL
END AS NVARCHAR(200)),INTERNATIONAL_BANK_ACCOUNT_NUMBER = CAST(CASE
	WHEN GR.BRONSYSTEEM = 'EP_NN' THEN CAST(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER AS NVARCHAR(250))
	WHEN GR.BRONSYSTEEM = 'OFS' THEN CAST(GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER  AS NVARCHAR(250))
	ELSE 'NA'
END AS NVARCHAR(200))","FROM ILSB_DDS.INVO_GELDREKENING GR
     INNER JOIN ILSB_DDS.INVO_INVESTERINGSOVEREENKOMST INVO ON GR.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID
     INNER JOIN ILSB_DDS.INVO_GELDREKENING_REFERENTIE GR_REF ON GR.GELDREKENING_ID = GR_REF.GELDREKENING_ID
     INNER JOIN ILSB_DDS.INVO_INVESTERINGSOVEREENKOMST_REFERENTIE INVO_REF ON INVO.INVESTERINGSOVEREENKOMST_ID = INVO_REF.INVESTERINGSOVEREENKOMST_ID
      LEFT JOIN ILSB_DDS.INVO_EFFECTENREKENING ER ON ER.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID
WHERE GR.REKENINGSOORT_ID NOT IN('N_1150')
AND (ER.EFFECTENREKENING_ID IS NULL
OR (ER.EFFECTENREKENING_ID IS NOT NULL AND GR.REKENINGSOORT_ID NOT IN('N_1050', 'O_1050'))
)"
CASH_ACCOUNT - Cashaccount,"SELECT INTERNATIONAL_BANK_ACCOUNT_NUMBER = CAST(CASE
	WHEN GR.BRONSYSTEEM = 'EP_NN' THEN CAST(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER AS NVARCHAR(250))
	WHEN GR.BRONSYSTEEM = 'OFS' THEN CAST(GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER  AS NVARCHAR(250))
	ELSE 'NA'
END AS NVARCHAR(200))","FROM ILSB_DDS.INVO_GELDREKENING GR
     INNER JOIN ILSB_DDS.INVO_INVESTERINGSOVEREENKOMST INVO ON GR.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID
     INNER JOIN ILSB_DDS.INVO_GELDREKENING_REFERENTIE GR_REF ON GR.GELDREKENING_ID = GR_REF.GELDREKENING_ID
     LEFT JOIN ILSB_DDS.INVO_EFFECTENREKENING ER ON ER.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID
WHERE GR.REKENINGSOORT_ID IN('N_1050', 'O_1050')
AND ER.EFFECTENREKENING_ID IS NOT NULL"
CONTRACT - Loan,"SELECT CLOSE_DATE = CAST(NULL AS NVARCHAR(200)),CLOSE_DATE_AT_INCEPTION = CAST(KRO.EINDDATUM_OVEREENKOMST AS NVARCHAR(200)),CONTRACT_IDENTIFIER = CAST(CAST(CASE
        WHEN KRO.BRONSYSTEEM = 'HOMES' THEN KRO_REF.HOMES_1_LENNR
        WHEN KRO.BRONSYSTEEM = 'HOUSE' THEN KRO_REF.HOUSE_1_HYPOTHECAIRELENING_LENINGNR
        WHEN KRO.BRONSYSTEEM = 'DAYBREAK' THEN KRO_REF.DAYBREAK_ACC_NBR
        WHEN KRO.BRONSYSTEEM = 'QUION' THEN KRO_REF.QUION_1_LENING_CONTRACT_NUMMER
        WHEN KRO.BRONSYSTEEM = 'CLOSE' THEN KRO_REF.CLOSE_1_CREDITDOSSIER_EXTERNALREFERENCE
        WHEN KRO.BRONSYSTEEM = 'CLOSE_MO' THEN KRO_REF.CLOSE_MO_1_OVEREENKOMST_ID
        WHEN KRO.BRONSYSTEEM = 'CLOSE_CK' THEN KRO_REF.DAYBREAK_ACC_NBR
        WHEN KRO.BRONSYSTEEM = 'MIDAS' THEN KRO_REF.HOMES_1_LENNR
        ELSE 'NA'
END AS VARCHAR(100)) AS NVARCHAR(200)),CONTRACT_SOURCE_SYSTEM_IDENTIFIER = CAST(KRO.BRONSYSTEEM AS NVARCHAR(200)),CONTRACT_STATUS_IDENTIFIER = CAST(CASE WHEN KRO.STATUS = 'LNLP' THEN 'ACTIVE' ELSE 'ENDED' END AS NVARCHAR(200)),CONTRACT_STATUS_IDENTIFIER_REVISION_DATE = CAST(KRO.STATUS_DATUM AS NVARCHAR(200)),DEAL_DATE = CAST(KRO.OORSPRONKELIJKE_PASSEERDATUM AS NVARCHAR(200)),ECONOMIC_OWNER_AT_INCEPTION_IDENTIFIER = CAST(CASE
    WHEN LEFT(RIGHT(RIGHT('00000000' + KRO.ECONOMISCHE_MAATSCHAPPIJ_CODE, 8), 4), 1) <> '0'
    THEN '0' + RIGHT(RIGHT('00000000' + KRO.ECONOMISCHE_MAATSCHAPPIJ_CODE, 8), 3)
    WHEN RIGHT(RIGHT('00000000' + KRO.ECONOMISCHE_MAATSCHAPPIJ_CODE, 8), 4) = '0000'
    THEN LEFT(RIGHT('00000000' + KRO.ECONOMISCHE_MAATSCHAPPIJ_CODE, 8), 4)
    ELSE RIGHT(RIGHT('00000000' + KRO.ECONOMISCHE_MAATSCHAPPIJ_CODE, 8), 4)
END AS NVARCHAR(200)),ECONOMIC_OWNER_AT_INCEPTION_ROLE_TYPE_IDENTIFIER = CAST('ECONOMIC_OWNER_AT_INCEPTION' AS NVARCHAR(200)),ECONOMIC_OWNER_AT_INCEPTION_SOURCE_SYSTEM_IDENTIFIER = CAST('TO_BE_DETERMINED' AS NVARCHAR(200)),ECONOMIC_OWNER_IDENTIFIER = CAST(CASE WHEN [KRO].ECONOMISCHE_MAATSCHAPPIJ_CODE IS NULL THEN NULL WHEN LE_REF.FINANCIELE_BU_CODE IS NULL THEN '?' ELSE LE_REF.[FINANCIELE_BU_CODE] END AS NVARCHAR(200)),ECONOMIC_OWNER_SOURCE_SYSTEM_IDENTIFIER = CAST('TO_BE_DETERMINED' AS NVARCHAR(200)),FRAUD_INDICATOR = CAST('TO_BE_DETERMINED' AS NVARCHAR(200)),INCEPTION_DATE = CAST(KRO.INGANGSDATUM_OVEREENKOMST AS NVARCHAR(200)),LEGAL_OWNER_IDENTIFIER = CAST(CASE
    WHEN RIGHT('00000000' + KRO.JURIDISCHE_MAATSCHAPPIJ_CODE, 8) = '00150012' THEN '0012'
    WHEN RIGHT('00000000' + KRO.JURIDISCHE_MAATSCHAPPIJ_CODE, 8) = '000I0550' THEN '0550'
        ELSE LEFT(RIGHT('00000000' + KRO.JURIDISCHE_MAATSCHAPPIJ_CODE, 8), 4)
END AS NVARCHAR(200)),LEGAL_OWNER_ROLE_TYPE_IDENTIFIER = CAST('LEGAL_OWNER' AS NVARCHAR(200)),LEGAL_OWNER_SOURCE_SYSTEM_IDENTIFIER = CAST('TO_BE_DETERMINED' AS NVARCHAR(200)),PRODUCT_IDENTIFIER = CAST(CAST([KRO].[OVEREENKOMST_TYPE] AS VARCHAR(100)) AS NVARCHAR(200)),REPORTING_CONTRACT_IDENTIFIER = CAST('TO_BE_DETERMINED' AS NVARCHAR(200)),SERVICER_IDENTIFIER = CAST(case when KRO.BRONSYSTEEM = 'QUION' then 'QUION' else '0500' end AS NVARCHAR(200)),SERVICER_ROLE_TYPE_IDENTIFIER = CAST('SERVICER' AS NVARCHAR(200)),SERVICER_SOURCE_SYSTEM_IDENTIFIER = CAST('TO_BE_DETERMINED' AS NVARCHAR(200)),WRITE_OFF_TYPE_IDENTIFIER = CAST(NULL AS NVARCHAR(200))","FROM ILH_DDS.KRO_KREDIETOVEREENKOMST KRO
     INNER JOIN ILH_DDS.KRO_KREDIETOVEREENKOMST_REFERENTIE KRO_REF ON KRO.OVEREENKOMST_ID = KRO_REF.OVEREENKOMST_ID
     INNER JOIN KRO_KREDIETOVEREENKOMST_SELECT KRO_REF2 ON KRO.OVEREENKOMST_ID = KRO_REF2.OVEREENKOMST_ID AND KRO_REF2.ROW_NUM = 1
        LEFT JOIN GBV_TMP_Legal_Entities_Hierachy LE_REF
    ON LE_REF.ECONOMISCHE_MAATSCHAPPIJ_CODE = CAST(KRO.ECONOMISCHE_MAATSCHAPPIJ_CODE AS NVARCHAR(200))
    WHERE KRO.VERSIENR = 0"
CONTRACT - Savings and Investments,"SELECT CLOSE_DATE = CAST(NULL AS NVARCHAR(200)),CLOSE_DATE_AT_INCEPTION = CAST(INVO.EINDDATUM AS NVARCHAR(200)),CONTRACT_IDENTIFIER = CAST(CASE
        WHEN INVO.BRONSYSTEEM = 'EP_NN' THEN CAST(INVO_REF.EP_NN_PRODUCTDETAIL_PRODUCT_ID AS NVARCHAR(250))
        WHEN INVO.BRONSYSTEEM = 'OFS' THEN CAST(INVO_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER  AS NVARCHAR(250))
        ELSE 'NA'
END AS NVARCHAR(200)),CONTRACT_SOURCE_SYSTEM_IDENTIFIER = CAST(INVO.BRONSYSTEEM AS NVARCHAR(200)),CONTRACT_STATUS_IDENTIFIER = CAST(NULL AS NVARCHAR(200)),CONTRACT_STATUS_IDENTIFIER_REVISION_DATE = CAST(NULL AS NVARCHAR(200)),DEAL_DATE = CAST(INVO.INGANGSDATUM AS NVARCHAR(200)),ECONOMIC_OWNER_AT_INCEPTION_IDENTIFIER = CAST(CASE
    WHEN INVO.ECONOMISCHE_MAATSCHAPPIJ = 'I0500'
    THEN '0500'
    ELSE INVO.ECONOMISCHE_MAATSCHAPPIJ
END AS NVARCHAR(200)),ECONOMIC_OWNER_AT_INCEPTION_ROLE_TYPE_IDENTIFIER = CAST('ECONOMIC_OWNER_AT_INCEPTION' AS NVARCHAR(200)),ECONOMIC_OWNER_AT_INCEPTION_SOURCE_SYSTEM_IDENTIFIER = CAST('TO_BE_DETERMINED' AS NVARCHAR(200)),ECONOMIC_OWNER_IDENTIFIER = CAST(CASE
    WHEN INVO.ECONOMISCHE_MAATSCHAPPIJ = 'I0500'
    THEN '0500'
    ELSE INVO.ECONOMISCHE_MAATSCHAPPIJ
END AS NVARCHAR(200)),ECONOMIC_OWNER_SOURCE_SYSTEM_IDENTIFIER = CAST('TO_BE_DETERMINED' AS NVARCHAR(200)),FRAUD_INDICATOR = CAST(NULL AS NVARCHAR(200)),INCEPTION_DATE = CAST(INVO.INGANGSDATUM AS NVARCHAR(200)),LEGAL_OWNER_IDENTIFIER = CAST(CASE
    WHEN INVO.JURIDISCHE_MAATSCHAPPIJ = 'I0500'
    THEN '0500'
    ELSE INVO.JURIDISCHE_MAATSCHAPPIJ
END AS NVARCHAR(200)),LEGAL_OWNER_ROLE_TYPE_IDENTIFIER = CAST('LEGAL_OWNER' AS NVARCHAR(200)),LEGAL_OWNER_SOURCE_SYSTEM_IDENTIFIER = CAST('TO_BE_DETERMINED' AS NVARCHAR(200)),PRODUCT_IDENTIFIER = CAST(CAST([INVO].[PRODUCT_ID] AS VARCHAR(100)) AS NVARCHAR(200)),REPORTING_CONTRACT_IDENTIFIER = CAST('TO_BE_DETERMINED' AS NVARCHAR(200)),SERVICER_IDENTIFIER = CAST(CASE
    WHEN INVO.JURIDISCHE_MAATSCHAPPIJ = 'I0500'
    THEN '0500'
    ELSE INVO.JURIDISCHE_MAATSCHAPPIJ
END AS NVARCHAR(200)),SERVICER_ROLE_TYPE_IDENTIFIER = CAST('SERVICER' AS NVARCHAR(200)),SERVICER_SOURCE_SYSTEM_IDENTIFIER = CAST('TO_BE_DETERMINED' AS NVARCHAR(200)),WRITE_OFF_TYPE_IDENTIFIER = CAST(NULL AS NVARCHAR(200))","FROM ILSB_DDS.INVO_INVESTERINGSOVEREENKOMST INVO
     INNER JOIN ILSB_DDS.INVO_INVESTERINGSOVEREENKOMST_REFERENTIE INVO_REF ON INVO.INVESTERINGSOVEREENKOMST_ID = INVO_REF.INVESTERINGSOVEREENKOMST_ID
WHERE 1=1"
CREDIT - Credit,"SELECT AMORTIZATION_TYPE_IDENTIFIER = CAST(KR.AFLOSVORM_CODE AS NVARCHAR(200)),CLAIMABLE_EXPENSES_PAST_DUE_AT_INCEPTION = CAST(NULL AS NVARCHAR(200)),DURATION_IN_MONTHS = CAST(KR.DUUR_IN_MAANDEN AS NVARCHAR(200)),INSTRUMENT_IDENTIFIER = CAST(CAST(ISNULL(KR.BRONSYSTEEM,'') AS NVARCHAR(250)) + '#'+ CASE WHEN KR.BRONSYSTEEM = 'QUION' THEN ISNULL(CAST(KRO_REF.QUION_1_LENING_CONTRACT_NUMMER AS NVARCHAR(250)),'') +'#'+ ISNULL(CAST(KRO_REF.QUION_1_LENING_NUMMER AS NVARCHAR(250)),'')+ '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM = 'CLOSE' THEN ISNULL(CAST(KRO_REF.CLOSE_1_CREDITDOSSIER_EXTERNALREFERENCE AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM IN ('HOMES','MIDAS') THEN ISNULL(CAST(KRO_REF.HOMES_1_LENNR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM = 'HOUSE' THEN ISNULL(CAST(KRO_REF.HOUSE_1_HYPOTHECAIRELENING_LENINGNR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM = 'CLOSE_MO' THEN ISNULL(CAST(KRO_REF.CLOSE_MO_1_OVEREENKOMST_ID AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM IN ('DAYBREAK', 'CLOSE_CK') THEN ISNULL(CAST(KRO_REF.DAYBREAK_ACC_NBR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  ELSE ''+'#' + CAST(KR.KREDIET_ID AS NVARCHAR(250)) END AS NVARCHAR(200)),INSTRUMENT_SUBTYPE_IDENTIFIER = CAST(CASE
    WHEN KR.KREDIET_PRODUCT_CODE LIKE 'DK%'
    THEN 'REVOLVING_CREDIT'
    WHEN KR.KREDIET_PRODUCT_CODE LIKE 'AK%'
    THEN 'PERSONAL_LOAN'
    ELSE 'MORTGAGE_LOAN_PART'
END AS NVARCHAR(200)),INTEREST_PAST_DUE_AT_INCEPTION = CAST(NULL AS NVARCHAR(200)),LEGAL_MATURITY_DATE = CAST(KR.EINDDATUM_KREDIET AS NVARCHAR(200)),LEGAL_MATURITY_DATE_AT_INCEPTION = CAST(NULL AS NVARCHAR(200)),NUMBER_OF_SIGNIFICANT_PREPAYMENT_IN_12_MONTHS = CAST(NULL AS NVARCHAR(200)),PENALTY_FEES_PAST_DUE_AT_INCEPTION = CAST(NULL AS NVARCHAR(200)),PRINCIPAL_AMOUNT_PAST_DUE_AT_INCEPTION = CAST(NULL AS NVARCHAR(200)),PROBATION_INDICATOR = CAST('NO' AS NVARCHAR(200))","FROM ILH_DDS.KRO_KREDIETOVEREENKOMST KRO
INNER JOIN ILH_DDS.KRO_KREDIETOVEREENKOMST_REFERENTIE KRO_REF
ON KRO.OVEREENKOMST_ID = KRO_REF.OVEREENKOMST_ID
INNER JOIN ILH_DDS.KRO_KREDIET KR
ON KRO.OVEREENKOMST_ID = KR.OVEREENKOMST_ID
AND KRO.VERSIENR = KR.VERSIENR
WHERE KRO.VERSIENR = 0 AND KRO.STATUS = 'LNLP'"
DEPOSIT - Cashaccount,"SELECT BLOCKED_QUALIFIER_IDENTIFIER = CAST(GR.BLOKKERING_TYPE AS NVARCHAR(200)),BLOCKED_REASON_IDENTIFIER = CAST(NULL AS NVARCHAR(200)),INSTRUMENT_IDENTIFIER = CAST(CASE
	WHEN GR.BRONSYSTEEM = 'EP_NN' THEN CAST(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER AS NVARCHAR(250))
	WHEN GR.BRONSYSTEEM = 'OFS' THEN CAST(GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER  AS NVARCHAR(250))
	ELSE 'NA'
END AS NVARCHAR(200)),INSTRUMENT_SUBTYPE_IDENTIFIER = CAST('CASH_ACCOUNT' AS NVARCHAR(200))","FROM ILSB_DDS.INVO_GELDREKENING GR
     INNER JOIN ILSB_DDS.INVO_INVESTERINGSOVEREENKOMST INVO ON GR.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID
     INNER JOIN ILSB_DDS.INVO_GELDREKENING_REFERENTIE GR_REF ON GR.GELDREKENING_ID = GR_REF.GELDREKENING_ID
     LEFT JOIN ILSB_DDS.INVO_EFFECTENREKENING ER ON ER.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID
WHERE GR.REKENINGSOORT_ID IN ('N_1050', 'O_1050')
AND ER.EFFECTENREKENING_ID IS NOT NULL"
DEPOSIT - Fixed Term Savings Deposit,"SELECT BLOCKED_QUALIFIER_IDENTIFIER = CAST(GR.BLOKKERING_TYPE AS NVARCHAR(200)),BLOCKED_REASON_IDENTIFIER = CAST(NULL AS NVARCHAR(200)),INSTRUMENT_IDENTIFIER = CAST(GR.BRONSYSTEEM + '#'+CASE
	WHEN GR.BRONSYSTEEM = 'EP_NN' THEN CAST(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER AS NVARCHAR(250))
	WHEN GR.BRONSYSTEEM = 'OFS' THEN CAST(GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER  AS NVARCHAR(250))
	ELSE 'NA'
END AS NVARCHAR(200)),INSTRUMENT_SUBTYPE_IDENTIFIER = CAST('FIXED_TERM_SAVINGS_DEPOSIT' AS NVARCHAR(200))","FROM ILSB_DDS.INVO_GELDREKENING GR
     INNER JOIN ILSB_DDS.INVO_INVESTERINGSOVEREENKOMST INVO ON GR.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID
     INNER JOIN ILSB_DDS.INVO_GELDREKENING_REFERENTIE GR_REF ON GR.GELDREKENING_ID = GR_REF.GELDREKENING_ID
WHERE REKENINGSOORT_ID IN ('N_1150')"
DEPOSIT - Savingsaccount,"SELECT BLOCKED_QUALIFIER_IDENTIFIER = CAST(GR.BLOKKERING_TYPE AS NVARCHAR(200)),BLOCKED_REASON_IDENTIFIER = CAST(NULL AS NVARCHAR(200)),INSTRUMENT_IDENTIFIER = CAST(CASE
	WHEN GR.BRONSYSTEEM = 'EP_NN' THEN CAST(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER AS NVARCHAR(250))
	WHEN GR.BRONSYSTEEM = 'OFS' THEN CAST(GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER  AS NVARCHAR(250))
	ELSE 'NA'
END AS NVARCHAR(200)),INSTRUMENT_SUBTYPE_IDENTIFIER = CAST('SAVINGS_ACCOUNT' AS NVARCHAR(200))","FROM ILSB_DDS.INVO_GELDREKENING GR
     INNER JOIN ILSB_DDS.INVO_INVESTERINGSOVEREENKOMST INVO ON GR.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID
     INNER JOIN ILSB_DDS.INVO_GELDREKENING_REFERENTIE GR_REF ON GR.GELDREKENING_ID = GR_REF.GELDREKENING_ID
     LEFT JOIN ILSB_DDS.INVO_EFFECTENREKENING ER ON ER.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID
WHERE GR.REKENINGSOORT_ID NOT IN('N_1150')
AND (ER.EFFECTENREKENING_ID IS NULL
OR (ER.EFFECTENREKENING_ID IS NOT NULL AND GR.REKENINGSOORT_ID NOT IN('N_1050', 'O_1050'))
)"
FIXED_TERM_DEPOSIT - Fixed Term Savings Deposit,"SELECT ACCOUNT_NUMBER = CAST(GR.BRONSYSTEEM + '#'+CASE
	WHEN GR.BRONSYSTEEM = 'EP_NN' THEN CAST(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER AS NVARCHAR(250))
	WHEN GR.BRONSYSTEEM = 'OFS' THEN CAST(GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER  AS NVARCHAR(250))
	ELSE 'NA'
END AS NVARCHAR(200)),CONTRACT_SOURCE_SYSTEM_IDENTIFIER = CAST(INVO.BRONSYSTEEM AS NVARCHAR(200))","FROM ILSB_DDS.INVO_GELDREKENING GR
     INNER JOIN ILSB_DDS.INVO_INVESTERINGSOVEREENKOMST INVO ON GR.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID
     INNER JOIN ILSB_DDS.INVO_GELDREKENING_REFERENTIE GR_REF ON GR.GELDREKENING_ID = GR_REF.GELDREKENING_ID
WHERE REKENINGSOORT_ID IN('N_1150')"
INSTRUMENT - Credit,"SELECT BALANCE_AMOUNT = CAST(KR.RESTANT_HOOFDSOM_BEDRAG AS NVARCHAR(200)),BALANCE_AMOUNT_AT_INCEPTION = CAST(KR.OORSPRONKELIJK_HOOFDSOM_BEDRAG AS NVARCHAR(200)),CLOSE_DATE = CAST(KR.AFMELDDATUM AS NVARCHAR(200)),CONTRACT_IDENTIFIER = CAST(CAST(CASE
	WHEN KRO.BRONSYSTEEM = 'HOMES' THEN KRO_REF.HOMES_1_LENNR
	WHEN KRO.BRONSYSTEEM = 'HOUSE' THEN KRO_REF.HOUSE_1_HYPOTHECAIRELENING_LENINGNR
	WHEN KRO.BRONSYSTEEM = 'DAYBREAK' THEN KRO_REF.DAYBREAK_ACC_NBR
	WHEN KRO.BRONSYSTEEM = 'QUION' THEN KRO_REF.QUION_1_LENING_CONTRACT_NUMMER
	WHEN KRO.BRONSYSTEEM = 'CLOSE' THEN KRO_REF.CLOSE_1_CREDITDOSSIER_EXTERNALREFERENCE
	WHEN KRO.BRONSYSTEEM = 'CLOSE_MO' THEN KRO_REF.CLOSE_MO_1_OVEREENKOMST_ID
	WHEN KRO.BRONSYSTEEM = 'CLOSE_CK' THEN KRO_REF.DAYBREAK_ACC_NBR
	WHEN KRO.BRONSYSTEEM = 'MIDAS' THEN KRO_REF.HOMES_1_LENNR
	ELSE 'NA'
END AS VARCHAR(100)) AS NVARCHAR(200)),CONTRACT_SOURCE_SYSTEM_IDENTIFIER = CAST(KRO.BRONSYSTEEM AS NVARCHAR(200)),DAYS_IN_ARREARS = CAST(KR.ACHTERSTAND_DAGEN AS NVARCHAR(200)),DAYS_PAST_DUE = CAST(NULL AS NVARCHAR(200)),GENERAL_TERMS_AND_CONDITIONS_IDENTIFIER = CAST(KR.ALGEMENE_VOORWAARDEN_CODE AS NVARCHAR(200)),IN_ARREARS_AMOUNT = CAST(KR.ACHTERSTAND_BEDRAG AS NVARCHAR(200)),INSTRUMENT_IDENTIFIER = CAST(CAST(ISNULL(KR.BRONSYSTEEM,'') AS NVARCHAR(250)) + '#'+ CASE WHEN KR.BRONSYSTEEM = 'QUION' THEN ISNULL(CAST(KRO_REF.QUION_1_LENING_CONTRACT_NUMMER AS NVARCHAR(250)),'') +'#'+ ISNULL(CAST(KRO_REF.QUION_1_LENING_NUMMER AS NVARCHAR(250)),'')+ '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM = 'CLOSE' THEN ISNULL(CAST(KRO_REF.CLOSE_1_CREDITDOSSIER_EXTERNALREFERENCE AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM IN ('HOMES','MIDAS') THEN ISNULL(CAST(KRO_REF.HOMES_1_LENNR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM = 'HOUSE' THEN ISNULL(CAST(KRO_REF.HOUSE_1_HYPOTHECAIRELENING_LENINGNR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM = 'CLOSE_MO' THEN ISNULL(CAST(KRO_REF.CLOSE_MO_1_OVEREENKOMST_ID AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM IN ('DAYBREAK', 'CLOSE_CK') THEN ISNULL(CAST(KRO_REF.DAYBREAK_ACC_NBR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  ELSE ''+'#' + CAST(KR.KREDIET_ID AS NVARCHAR(250)) END AS NVARCHAR(200)),INSTRUMENT_IN_ARREARS_INDICATOR = CAST(CASE WHEN [KR].[ACHTERSTAND_BEDRAG] IS NULL THEN NULL
WHEN [KR].[ACHTERSTAND_BEDRAG] > 0 THEN 'YES'
ELSE 'NO'
END AS NVARCHAR(200)),INSTRUMENT_STATUS_IDENTIFIER = CAST(case  [KR].[STATUS] when 'ACT' then 'ACTIVE' when 'AVR' then 'APPLICATION' when 'ND' then 'CANCELED_APPLICATION'  when 'END' then 'ENDED' else 'UNKNOWN' end  AS NVARCHAR(200)),INSTRUMENT_STATUS_IDENTIFIER_REVISION_DATE = CAST(KR.STATUS_DATUM AS NVARCHAR(200)),INSTRUMENT_SUBTYPE_IDENTIFIER = CAST(CASE
    WHEN KR.KREDIET_PRODUCT_CODE LIKE 'DK%'
    THEN 'REVOLVING_CREDIT'
    WHEN KR.KREDIET_PRODUCT_CODE LIKE 'AK%'
    THEN 'PERSONAL_LOAN'
    ELSE 'MORTGAGE_LOAN_PART'
END AS NVARCHAR(200)),INSTRUMENT_TYPE_IDENTIFIER = CAST(KR.KREDIET_PRODUCT_CODE AS NVARCHAR(200)),LATEST_PAST_DUE_STATUS_DATE = CAST(NULL AS NVARCHAR(200)),PAST_DUE_AMOUNT = CAST(NULL AS NVARCHAR(200)),REPORTING_INSTRUMENT_IDENTIFIER = CAST('TO_BE_DETERMINED' AS NVARCHAR(200)),SETTLEMENT_DATE = CAST(KR.INGANGSDATUM_KREDIET AS NVARCHAR(200))","FROM ILH_DDS.KRO_KREDIETOVEREENKOMST KRO
INNER JOIN ILH_DDS.KRO_KREDIETOVEREENKOMST_REFERENTIE KRO_REF
ON KRO.OVEREENKOMST_ID = KRO_REF.OVEREENKOMST_ID
INNER JOIN ILH_DDS.KRO_KREDIET KR
ON KRO.OVEREENKOMST_ID = KR.OVEREENKOMST_ID
AND KRO.VERSIENR = KR.VERSIENR
WHERE KRO.VERSIENR = 0 AND KRO.STATUS = 'LNLP'"
INSTRUMENT - Savings,"SELECT BALANCE_AMOUNT = CAST(GR.BOEKSALDO AS NVARCHAR(200)),BALANCE_AMOUNT_AT_INCEPTION = CAST(NULL AS NVARCHAR(200)),CLOSE_DATE = CAST(NULL AS NVARCHAR(200)),CONTRACT_IDENTIFIER = CAST(CASE
	WHEN INVO.BRONSYSTEEM = 'EP_NN' THEN CAST(INVO_REF.EP_NN_PRODUCTDETAIL_PRODUCT_ID AS NVARCHAR(250))
	WHEN INVO.BRONSYSTEEM = 'OFS' THEN CAST(INVO_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER  AS NVARCHAR(250))
	ELSE 'NA'
END AS NVARCHAR(200)),CONTRACT_SOURCE_SYSTEM_IDENTIFIER = CAST(INVO.BRONSYSTEEM AS NVARCHAR(200)),DAYS_IN_ARREARS = CAST(NULL AS NVARCHAR(200)),DAYS_PAST_DUE = CAST(NULL AS NVARCHAR(200)),GENERAL_TERMS_AND_CONDITIONS_IDENTIFIER = CAST(NULL AS NVARCHAR(200)),IN_ARREARS_AMOUNT = CAST(INVO_A.ACHTERSTAND AS NVARCHAR(200)),INSTRUMENT_IDENTIFIER = CAST(CASE WHEN GR.REKENINGSOORT_ID  in ('N_1150')  THEN  GR.BRONSYSTEEM + '#' ELSE '' END
+
CASE
	WHEN GR.BRONSYSTEEM = 'EP_NN' THEN CAST(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER AS NVARCHAR(250))
	WHEN GR.BRONSYSTEEM = 'OFS' THEN CAST(GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER  AS NVARCHAR(250))
	ELSE 'NA'
END AS NVARCHAR(200)),INSTRUMENT_IN_ARREARS_INDICATOR = CAST(CASE WHEN [INVO_A].[ACHTERSTAND] IS NULL THEN NULL
WHEN [INVO_A].[ACHTERSTAND] > 0 THEN 'YES'
ELSE 'NO'
END AS NVARCHAR(200)),INSTRUMENT_STATUS_IDENTIFIER = CAST(GR.REKENING_STATUS_CODE AS NVARCHAR(200)),INSTRUMENT_STATUS_IDENTIFIER_REVISION_DATE = CAST(GR.REKENING_STATUS_DATUM AS NVARCHAR(200)),INSTRUMENT_SUBTYPE_IDENTIFIER = CAST(CASE WHEN GR.REKENINGSOORT_ID IN ('N_1150') THEN 'FIXED_TERM_SAVINGS_DEPOSIT'
WHEN ER.EFFECTENREKENING_ID IS NOT NULL AND GR.REKENINGSOORT_ID IN ('N_1050','O_1050') THEN 'CASH_ACCOUNT'
ELSE  'SAVINGS_ACCOUNT' END AS NVARCHAR(200)),INSTRUMENT_TYPE_IDENTIFIER = CAST(GR.REKENINGSOORT_ID AS NVARCHAR(200)),LATEST_PAST_DUE_STATUS_DATE = CAST(NULL AS NVARCHAR(200)),PAST_DUE_AMOUNT = CAST(NULL AS NVARCHAR(200)),REPORTING_INSTRUMENT_IDENTIFIER = CAST(NULL AS NVARCHAR(200)),SETTLEMENT_DATE = CAST(GR.INGANGSDATUM_LOOPTIJD AS NVARCHAR(200))","FROM ILSB_DDS.INVO_GELDREKENING GR
     INNER JOIN ILSB_DDS.INVO_INVESTERINGSOVEREENKOMST INVO ON GR.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID
     INNER JOIN ILSB_DDS.INVO_INVESTERINGSOVEREENKOMST_REFERENTIE INVO_REF ON GR.INVESTERINGSOVEREENKOMST_ID = INVO_REF.INVESTERINGSOVEREENKOMST_ID
     INNER JOIN ILSB_DDS.INVO_GELDREKENING_REFERENTIE GR_REF ON GR.GELDREKENING_ID = GR_REF.GELDREKENING_ID
     LEFT JOIN ILSB_DDS.INVO_ACHTERSTAND INVO_A ON GR.INVESTERINGSOVEREENKOMST_ID = INVO_A.INVESTERINGSOVEREENKOMST_ID
     LEFT JOIN ILSB_DDS.INVO_EFFECTENREKENING ER ON ER.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID"
INTEREST_BEARING_INSTRUMENT - Credit,"SELECT ACCRUED_INTEREST_AMOUNT = CAST(KR.TRANSITOIR_RENTE_BEDRAG AS NVARCHAR(200)),ANNUALISED_INTEREST_RATE = CAST(KR.NOMINAAL_RENTE_PERCENTAGE AS NVARCHAR(200)),EFFECTIVE_ANNUALISED_INTEREST_RATE_AT_INTEREST_RATE_START_DATE = CAST(KR_RA.EFFECTIEF_RENTE_PERCENTAGE AS NVARCHAR(200)),FIXED_INTEREST_RATE_INDICATOR = CAST(case when upper(RENTETYPE_CODE) = '01' then 'YES' else 'NO' end AS NVARCHAR(200)),INSTRUMENT_IDENTIFIER = CAST(CAST(ISNULL(KR.BRONSYSTEEM,'') AS NVARCHAR(250)) + '#'+ CASE WHEN KR.BRONSYSTEEM = 'QUION' THEN ISNULL(CAST(KRO_REF.QUION_1_LENING_CONTRACT_NUMMER AS NVARCHAR(250)),'') +'#'+ ISNULL(CAST(KRO_REF.QUION_1_LENING_NUMMER AS NVARCHAR(250)),'')+ '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM = 'CLOSE' THEN ISNULL(CAST(KRO_REF.CLOSE_1_CREDITDOSSIER_EXTERNALREFERENCE AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM IN ('HOMES','MIDAS') THEN ISNULL(CAST(KRO_REF.HOMES_1_LENNR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM = 'HOUSE' THEN ISNULL(CAST(KRO_REF.HOUSE_1_HYPOTHECAIRELENING_LENINGNR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM = 'CLOSE_MO' THEN ISNULL(CAST(KRO_REF.CLOSE_MO_1_OVEREENKOMST_ID AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM IN ('DAYBREAK', 'CLOSE_CK') THEN ISNULL(CAST(KRO_REF.DAYBREAK_ACC_NBR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  ELSE ''+'#' + CAST(KR.KREDIET_ID AS NVARCHAR(250)) END AS NVARCHAR(200)),INSTRUMENT_SUBTYPE_IDENTIFIER = CAST(CASE
    WHEN KR.KREDIET_PRODUCT_CODE LIKE 'DK%'
    THEN 'REVOLVING_CREDIT'
    WHEN KR.KREDIET_PRODUCT_CODE LIKE 'AK%'
    THEN 'PERSONAL_LOAN'
    ELSE 'MORTGAGE_LOAN_PART'
END AS NVARCHAR(200)),INTEREST_DAY_COUNT_CONVENTION_IDENTIFIER = CAST(KR.RENTEBEREKENINGSMETHODE_CODE AS NVARCHAR(200)),INTEREST_PAYMENT_FREQUENCY_IDENTIFIER = CAST(CAST([KR_RA].[FREQUENTIE_CODE] AS VARCHAR(100)) AS NVARCHAR(200)),INTEREST_RATE_DETERMINATION_DATE = CAST(KR_RA.PEILDATUM_RENTE AS NVARCHAR(200)),INTEREST_RATE_DURATION_IN_MONTHS_AT_INCEPTION = CAST(NULL AS NVARCHAR(200)),INTEREST_RATE_DURATION_IN_MONTHS_AT_INTEREST_RATE_START_DATE = CAST(KR_RA.RENTEVAST_DUUR_IN_MAANDEN AS NVARCHAR(200)),INTEREST_RATE_START_DATE = CAST(KR_RA.INGANGSDATUM_RENTE_AFSPRAAK AS NVARCHAR(200)),NEXT_INTEREST_RATE_RESET_DATE = CAST(KR_RA.EINDDATUM_RENTE_AFSPRAAK AS NVARCHAR(200)),REFERENCE_INTEREST_RATE_IDENTIFIER = CAST(NULL AS NVARCHAR(200))","FROM ILH_DDS.KRO_KREDIETOVEREENKOMST KRO
INNER JOIN ILH_DDS.KRO_KREDIETOVEREENKOMST_REFERENTIE KRO_REF
ON KRO.OVEREENKOMST_ID = KRO_REF.OVEREENKOMST_ID
INNER JOIN ILH_DDS.KRO_KREDIET KR
ON KRO.OVEREENKOMST_ID = KR.OVEREENKOMST_ID
AND KRO.VERSIENR = KR.VERSIENR
LEFT JOIN ILH_DDS.KRO_KREDIET_RENTE_AFSPRAAK KR_RA
ON KR.OVEREENKOMST_ID = KR_RA.OVEREENKOMST_ID
AND KR.VERSIENR = KR_RA.VERSIENR
AND KR.KREDIET_ID  = KR_RA.KREDIET_ID
AND KR_RA.INGANGSDATUM_RENTE_AFSPRAAK <= KR.PEILDATUM
AND KR.PEILDATUM <= KR_RA.EINDDATUM_RENTE_AFSPRAAK
WHERE KRO.VERSIENR = 0 AND KRO.STATUS = 'LNLP'"
INTEREST_BEARING_INSTRUMENT - Savings,"SELECT ACCRUED_INTEREST_AMOUNT = CAST(GR.TRANSITOIR_RENTEBEDRAG AS NVARCHAR(200)),ANNUALISED_INTEREST_RATE = CAST(GR.NOMINAAL_JAARRENTEPERCENTAGE_CR AS NVARCHAR(200)),EFFECTIVE_ANNUALISED_INTEREST_RATE_AT_INTEREST_RATE_START_DATE = CAST(GR_RA.EFFECTIEF_RENTEPERCENTAGE_CR AS NVARCHAR(200)),FIXED_INTEREST_RATE_INDICATOR = CAST(CASE WHEN RENTETYPE_CODE IS NULL THEN  NULL
WHEN  UPPER(RENTETYPE_CODE) = 'VARIABLE' THEN 'NO'
ELSE 'YES'
END AS NVARCHAR(200)),INSTRUMENT_IDENTIFIER = CAST(CASE WHEN GR.REKENINGSOORT_ID  in ('N_1150')  THEN  GR.BRONSYSTEEM + '#' ELSE '' END
+
CASE
	WHEN GR.BRONSYSTEEM = 'EP_NN' THEN CAST(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER AS NVARCHAR(250))
	WHEN GR.BRONSYSTEEM = 'OFS' THEN CAST(GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER  AS NVARCHAR(250))
	ELSE 'NA'
END AS NVARCHAR(200)),INSTRUMENT_SUBTYPE_IDENTIFIER = CAST(CASE WHEN GR.REKENINGSOORT_ID IN ('N_1150') THEN 'FIXED_TERM_SAVINGS_DEPOSIT'
WHEN ER.EFFECTENREKENING_ID IS NOT NULL AND GR.REKENINGSOORT_ID IN ('N_1050','O_1050') THEN 'CASH_ACCOUNT'
ELSE  'SAVINGS_ACCOUNT' END AS NVARCHAR(200)),INTEREST_DAY_COUNT_CONVENTION_IDENTIFIER = CAST(GR_RA.RENTEBEREKENINGSMETHODE_CODE AS NVARCHAR(200)),INTEREST_PAYMENT_FREQUENCY_IDENTIFIER = CAST(CAST([GR_RA].[FREQUENTIE_CODE] AS VARCHAR(100)) AS NVARCHAR(200)),INTEREST_RATE_DETERMINATION_DATE = CAST(NULL AS NVARCHAR(200)),INTEREST_RATE_DURATION_IN_MONTHS_AT_INCEPTION = CAST(GR_RA.RENTEVAST_DUUR_IN_MAANDEN AS NVARCHAR(200)),INTEREST_RATE_DURATION_IN_MONTHS_AT_INTEREST_RATE_START_DATE = CAST(GR_RA.RENTEVAST_DUUR_IN_MAANDEN AS NVARCHAR(200)),INTEREST_RATE_START_DATE = CAST(GR_RA.INGANGSDATUM_RENTE_AFSPRAAK AS NVARCHAR(200)),NEXT_INTEREST_RATE_RESET_DATE = CAST(GR_RA.EINDDATUM_RENTE_AFSPRAAK AS NVARCHAR(200)),REFERENCE_INTEREST_RATE_IDENTIFIER = CAST(NULL AS NVARCHAR(200))","FROM ILSB_DDS.INVO_GELDREKENING GR
     INNER JOIN ILSB_DDS.INVO_INVESTERINGSOVEREENKOMST INVO ON GR.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID
     INNER JOIN ILSB_DDS.INVO_GELDREKENING_REFERENTIE GR_REF ON GR.GELDREKENING_ID = GR_REF.GELDREKENING_ID
     LEFT JOIN ILSB_DDS.INVO_GELDREKENING_RENTE_AFSPRAAK GR_RA ON GR.GELDREKENING_ID = GR_RA.GELDREKENING_ID
     LEFT JOIN ILSB_DDS.INVO_EFFECTENREKENING ER ON ER.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID"
MORTGAGE_LOAN_PART - Mortgage Loan Part,"SELECT ANNUAL_PENALTY_FREE_PREPAYMENT_AMOUNT = CAST(KR.JAARLIJKS_BOETEVRIJ_AFLOSBAAR_BEDRAG AS NVARCHAR(200)),ANNUALISED_GROSS_INTEREST_RATE = CAST(KR.BRUTO_RENTE_PERCENTAGE AS NVARCHAR(200)),BALANCE_AMOUNT_MINUS_TRANSFER_OF_PARTS_AGREED_AMOUNT = CAST(NULL AS NVARCHAR(200)),BOX_1_AMOUNT = CAST(KR.FISCAAL_AFTREKBAAR_BEDRAG AS NVARCHAR(200)),CONTRACT_IDENTIFIER = CAST(CAST(CASE
	WHEN KRO.BRONSYSTEEM = 'HOMES' THEN KRO_REF.HOMES_1_LENNR
	WHEN KRO.BRONSYSTEEM = 'HOUSE' THEN KRO_REF.HOUSE_1_HYPOTHECAIRELENING_LENINGNR
	WHEN KRO.BRONSYSTEEM = 'DAYBREAK' THEN KRO_REF.DAYBREAK_ACC_NBR
	WHEN KRO.BRONSYSTEEM = 'QUION' THEN KRO_REF.QUION_1_LENING_CONTRACT_NUMMER
	WHEN KRO.BRONSYSTEEM = 'CLOSE' THEN KRO_REF.CLOSE_1_CREDITDOSSIER_EXTERNALREFERENCE
	WHEN KRO.BRONSYSTEEM = 'CLOSE_MO' THEN KRO_REF.CLOSE_MO_1_OVEREENKOMST_ID
	WHEN KRO.BRONSYSTEEM = 'CLOSE_CK' THEN KRO_REF.DAYBREAK_ACC_NBR
	WHEN KRO.BRONSYSTEEM = 'MIDAS' THEN KRO_REF.HOMES_1_LENNR
	ELSE 'NA'
END AS VARCHAR(100)) AS NVARCHAR(200)),CONTRACT_SOURCE_SYSTEM_IDENTIFIER = CAST(KRO.BRONSYSTEEM AS NVARCHAR(200)),EXIT_STATUS_IDENTIFIER = CAST('TO_BE_DETERMINED' AS NVARCHAR(200)),FINAL_LOSS_AMOUNT = CAST(NULL AS NVARCHAR(200)),FINANCE_TYPE_IDENTIFIER = CAST(KR.FINANCIERING_SOORT_CODE AS NVARCHAR(200)),FULL_PREPAYMENT_PENALTY_FEE_METHOD_IDENTIFIER = CAST(KR.BOETECLAUSULE_CODE AS NVARCHAR(200)),MORTGAGE_LOAN_IDENTIFIER = CAST(CAST(CASE
	  WHEN KRO.BRONSYSTEEM = 'CLOSE' THEN ISNULL(CAST(KRO_REF.CLOSE_1_CREDITDOSSIER_EXTERNALREFERENCE AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(COALESCE(A_REF.HOUSE_1_MORTGAGEAPPLICATION_BACKOFFICEID,A_REF.HOUSE_2_MORTGAGEAPPLICATION_AANVRAAGID,A_REF.CLOSE_MO_1_AANVRAAG_ID,A_REF.HOMES_1_AANVRNR) AS NVARCHAR(250)),'')
	  WHEN KRO.BRONSYSTEEM IN ('HOMES','MIDAS') THEN ISNULL(CAST(KRO_REF.HOMES_1_LENNR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(COALESCE(A_REF.HOUSE_1_MORTGAGEAPPLICATION_BACKOFFICEID,A_REF.HOUSE_2_MORTGAGEAPPLICATION_AANVRAAGID,A_REF.CLOSE_MO_1_AANVRAAG_ID,A_REF.HOMES_1_AANVRNR) AS NVARCHAR(250)),'')
	  WHEN KRO.BRONSYSTEEM = 'HOUSE' THEN ISNULL(CAST(KRO_REF.HOUSE_1_HYPOTHECAIRELENING_LENINGNR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(COALESCE(A_REF.HOUSE_1_MORTGAGEAPPLICATION_BACKOFFICEID,A_REF.HOUSE_2_MORTGAGEAPPLICATION_AANVRAAGID,A_REF.CLOSE_MO_1_AANVRAAG_ID,A_REF.HOMES_1_AANVRNR) AS NVARCHAR(250)),'')
	  WHEN KRO.BRONSYSTEEM = 'CLOSE_MO' THEN ISNULL(CAST(KRO_REF.CLOSE_MO_1_OVEREENKOMST_ID AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(COALESCE(A_REF.HOUSE_1_MORTGAGEAPPLICATION_BACKOFFICEID,A_REF.HOUSE_2_MORTGAGEAPPLICATION_AANVRAAGID,A_REF.CLOSE_MO_1_AANVRAAG_ID,A_REF.HOMES_1_AANVRNR) AS NVARCHAR(250)),'')
	  WHEN KRO.BRONSYSTEEM IN ('DAYBREAK', 'CLOSE_CK') THEN ISNULL(CAST(KRO_REF.DAYBREAK_ACC_NBR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(COALESCE(A_REF.HOUSE_1_MORTGAGEAPPLICATION_BACKOFFICEID,A_REF.HOUSE_2_MORTGAGEAPPLICATION_AANVRAAGID,A_REF.CLOSE_MO_1_AANVRAAG_ID,A_REF.HOMES_1_AANVRNR) AS NVARCHAR(250)),'')
	  WHEN KRO.BRONSYSTEEM IN ('QUION') THEN ISNULL(CAST(KRO_REF.QUION_1_LENING_CONTRACT_NUMMER AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.INGANGSDATUM_KREDIET AS NVARCHAR(250)),'')
	  ELSE ''+'#' + '' END AS NVARCHAR(200)) AS NVARCHAR(200)),MORTGAGE_LOAN_PART_IDENTIFIER = CAST(CASE WHEN KR.BRONSYSTEEM = 'QUION' THEN ISNULL(CAST(KRO_REF.QUION_1_LENING_CONTRACT_NUMMER AS NVARCHAR(250)),'') +'#'+ ISNULL(CAST(KRO_REF.QUION_1_LENING_NUMMER AS NVARCHAR(250)),'')+ '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  WHEN KR.BRONSYSTEEM IN ('DAYBREAK', 'CLOSE_CK') THEN ISNULL(CAST(KRO_REF.DAYBREAK_ACC_NBR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'')
	  ELSE ISNULL(CAST(COALESCE(KRO_REF.CLOSE_1_CREDITDOSSIER_EXTERNALREFERENCE,KRO_REF.HOMES_1_LENNR,KRO_REF.HOUSE_1_HYPOTHECAIRELENING_LENINGNR, KRO_REF.CLOSE_MO_1_OVEREENKOMST_ID) AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KR.KREDIET_ID AS NVARCHAR(250)),'') END AS NVARCHAR(200)),MORTGAGE_REGISTRATION_IDENTIFIER = CAST(CAST(CASE
	  WHEN KRO.BRONSYSTEEM = 'CLOSE' THEN ISNULL(CAST(KRO_REF.CLOSE_1_CREDITDOSSIER_EXTERNALREFERENCE AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(COALESCE(KI_REF.HOUSE_1_MORTGAGEAPPLICATION_BACKOFFICEID,KI_REF.HOUSE_2_MORTGAGEAPPLICATION_AANVRAAGID,KI_REF.CLOSE_MO_1_AANVRAAG_ID,KI_REF.HOMES_1_AANVRNR) AS NVARCHAR(250)),'')
	  WHEN KRO.BRONSYSTEEM IN ('HOMES','MIDAS') THEN ISNULL(CAST(KRO_REF.HOMES_1_LENNR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(COALESCE(KI_REF.HOUSE_1_MORTGAGEAPPLICATION_BACKOFFICEID,KI_REF.HOUSE_2_MORTGAGEAPPLICATION_AANVRAAGID,KI_REF.CLOSE_MO_1_AANVRAAG_ID,KI_REF.HOMES_1_AANVRNR) AS NVARCHAR(250)),'')
	  WHEN KRO.BRONSYSTEEM = 'HOUSE' THEN ISNULL(CAST(KRO_REF.HOUSE_1_HYPOTHECAIRELENING_LENINGNR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(COALESCE(KI_REF.HOUSE_1_MORTGAGEAPPLICATION_BACKOFFICEID,KI_REF.HOUSE_2_MORTGAGEAPPLICATION_AANVRAAGID,KI_REF.CLOSE_MO_1_AANVRAAG_ID,KI_REF.HOMES_1_AANVRNR) AS NVARCHAR(250)),'')
	  WHEN KRO.BRONSYSTEEM = 'CLOSE_MO' THEN ISNULL(CAST(KRO_REF.CLOSE_MO_1_OVEREENKOMST_ID AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(COALESCE(KI_REF.HOUSE_1_MORTGAGEAPPLICATION_BACKOFFICEID,KI_REF.HOUSE_2_MORTGAGEAPPLICATION_AANVRAAGID,KI_REF.CLOSE_MO_1_AANVRAAG_ID,KI_REF.HOMES_1_AANVRNR) AS NVARCHAR(250)),'')
	  WHEN KRO.BRONSYSTEEM IN ('DAYBREAK', 'CLOSE_CK') THEN ISNULL(CAST(KRO_REF.DAYBREAK_ACC_NBR AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(COALESCE(KI_REF.HOUSE_1_MORTGAGEAPPLICATION_BACKOFFICEID,KI_REF.HOUSE_2_MORTGAGEAPPLICATION_AANVRAAGID,KI_REF.CLOSE_MO_1_AANVRAAG_ID,KI_REF.HOMES_1_AANVRNR) AS NVARCHAR(250)),'')
	  WHEN KRO.BRONSYSTEEM IN ('QUION') THEN ISNULL(CAST(KRO_REF.QUION_1_LENING_CONTRACT_NUMMER AS NVARCHAR(250)),'') + '#' + ISNULL(CAST(KRO_REF.QUION_1_LENING_NUMMER AS NVARCHAR(250)),'')
	  ELSE ''+'#' + '' END AS NVARCHAR(200)) AS NVARCHAR(200)),PENALTY_FREE_PREPAYMENT_CALCULATION_METHOD_IDENTIFIER = CAST(KR.JAARLIJKS_BOETEVRIJ_BEREKENINGMETHODE_CODE AS NVARCHAR(200)),PROVIDED_UNDER_NHG_CONDITIONS_INDICATOR = CAST(CASE
    WHEN KR.NHG_INDICATOR = 'N'
    THEN 'NO'
    WHEN KR.NHG_INDICATOR IN('J', 'F')
    THEN 'YES'
    ELSE NULL
END AS NVARCHAR(200)),REMAINING_ANNUAL_PENALTY_FREE_PREPAYMENT_AMOUNT = CAST(KR.JAARLIJKS_RESTANT_BOETEVRIJ_AFLOSBAAR_BEDRAG AS NVARCHAR(200)),REMAINING_BUILD_DEPOSIT_BALANCE_AMOUNT = CAST(NULL AS NVARCHAR(200)),TARGET_ECONOMIC_OWNER_IDENTIFIER = CAST(NULL AS NVARCHAR(200)),TARGET_ECONOMIC_OWNER_SOURCE_SYSTEM_IDENTIFIER = CAST(NULL AS NVARCHAR(200)),TRANSFER_OF_PARTS_AGREED_AMOUNT = CAST(NULL AS NVARCHAR(200))","FROM ILH_DDS.KRO_KREDIET KR
INNER JOIN ILH_DDS.KRO_KREDIETOVEREENKOMST KRO
ON KRO.OVEREENKOMST_ID = KR.OVEREENKOMST_ID
AND KRO.VERSIENR = KR.VERSIENR
INNER JOIN ILH_DDS.KRO_KREDIETOVEREENKOMST_REFERENTIE KRO_REF
ON KRO.OVEREENKOMST_ID = KRO_REF.OVEREENKOMST_ID
LEFT JOIN ILH_DDS.KRO_AANVRAAG_REFERENTIE A_REF
ON KR.OORSPRONKELIJK_AANVRAAG_ID = A_REF.AANVRAAG_ID
LEFT JOIN ILH_DDS.KRO_AANVRAAG_REFERENTIE KI_REF
ON KR.INSCHRIJVING_ID = KI_REF.AANVRAAG_ID
WHERE KRO.VERSIENR = 0 AND KRO.STATUS = 'LNLP'"
SAVINGS_ACCOUNT - Savingsaccount,"SELECT INTERNATIONAL_BANK_ACCOUNT_NUMBER = CAST(CASE
	WHEN GR.BRONSYSTEEM = 'EP_NN' THEN CAST(GR_REF.EP_NN_CASHACCOUNT_ACCOUNTNUMBER AS NVARCHAR(250))
	WHEN GR.BRONSYSTEEM = 'OFS' THEN CAST(GR_REF.OFS_INVESTMENTAGREEMENTACCOUNT_ACCOUNTNUMBER  AS NVARCHAR(250))
	ELSE 'NA'
END AS NVARCHAR(200))","FROM ILSB_DDS.INVO_GELDREKENING GR
     INNER JOIN ILSB_DDS.INVO_INVESTERINGSOVEREENKOMST INVO ON GR.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID
     INNER JOIN ILSB_DDS.INVO_GELDREKENING_REFERENTIE GR_REF ON GR.GELDREKENING_ID = GR_REF.GELDREKENING_ID
     LEFT JOIN ILSB_DDS.INVO_EFFECTENREKENING ER ON ER.INVESTERINGSOVEREENKOMST_ID = INVO.INVESTERINGSOVEREENKOMST_ID
WHERE GR.REKENINGSOORT_ID NOT IN('N_1150')
AND (ER.EFFECTENREKENING_ID IS NULL
OR (ER.EFFECTENREKENING_ID IS NOT NULL AND GR.REKENINGSOORT_ID NOT IN('N_1050', 'O_1050'))
)"
